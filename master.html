<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Master — Encrypted Messages</title>
<style>
  :root{--bg:#0f1720;--card:#0b1220;--accent:#eab308;--muted:#9aa4b2;--white:#eef2f7}
  body{margin:0; min-height:100vh; font-family:Helvetica,Arial,sans-serif; background:
    linear-gradient(180deg, #071027 0%, #0f1720 60%); color:var(--white); display:flex; align-items:center; justify-content:center; padding:40px;}
  .wrap{width:100%; max-width:880px;}
  header{display:flex; align-items:center; justify-content:space-between; margin-bottom:18px}
  h1{font-size:20px; margin:0}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:22px; box-shadow:0 10px 30px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.03)}
  .grid{display:grid; grid-template-columns: 1fr 260px; gap:18px}
  .messages{padding:6px 10px; display:flex; flex-direction:column; gap:10px; max-height:60vh; overflow:auto}
  .line{background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015)); padding:12px 14px; border-radius:8px; border:1px solid rgba(255,255,255,0.02); font-family:monospace; white-space:pre-wrap}
  .controls{display:flex; flex-direction:column; gap:12px}
  label{font-size:13px; color:var(--muted)}
  input[type="text"]{padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:var(--white); width:100%; box-sizing:border-box}
  button{padding:10px 12px; border-radius:8px; border:0; background:var(--accent); color:#071527; font-weight:700; cursor:pointer}
  .msg{height:18px; font-size:13px; color:var(--muted)}
  .controls .small{font-size:12px; color:var(--muted)}
  .reveal{margin-top:10px; color:#b7ffd3; font-family:monospace; white-space:pre-wrap}
  footer{margin-top:12px; font-size:12px; color:var(--muted)}
  @media (max-width:820px){ .grid{grid-template-columns:1fr; } .controls{order:2} }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Encrypted Messages — Master</h1>
      <div style="color:var(--muted);font-size:13px">Type any codeword to attempt decryption</div>
    </header>

    <div class="card">
      <div class="grid">
        <div>
          <div style="margin-bottom:10px; color:var(--muted); font-size:13px">Encoded lines</div>
          <div class="messages" id="messages">
            <!-- Pre-encoded lines (Vigenère with original key "master") -->
            <div class="line" data-encoded> Iedvsdq tg mlv unfxv jmnumyd </div>
            <div class="line" data-encoded> Fhw mvvmsmki ze bmkmvp ufwii fhw hpu aac </div>
            <div class="line" data-encoded> Yewm qv mt ebheugzm fp fhw kmmqr </div>
            <div class="line" data-encoded> Frmlx ea ofx iooehm xyasw rsl wngp </div>
            <div class="line" data-encoded> Burspv eodoiu, olsbq pauj ivzle </div>
          </div>
        </div>

        <div class="controls">
          <div>
            <label for="code">Codeword</label>
            <input id="code" type="text" placeholder="Enter any codeword" autocomplete="off" />
          </div>

          <div>
            <button id="tryBtn">Decrypt (use typed codeword)</button>
          </div>

          <div class="msg" id="status">The page will decrypt the lines using the codeword you provide, regardless of whether it’s the “correct” one.</div>

          <div class="small">If the key matches how the lines were encoded you’ll see readable text; otherwise you’ll see the character-wise decryption result (may be gibberish).</div>

          <div style="display:flex; gap:8px; margin-top:8px">
            <button id="revealBtn" style="background:transparent;color:var(--accent);border:1px solid rgba(234,179,8,0.12)">Show raw encoded</button>
            <button id="resetBtn" style="background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03)">Reset</button>
          </div>

          <div class="reveal" id="revealArea" aria-hidden="true" style="display:none"></div>
        </div>
      </div>
    </div>

    <footer>Designed for the <strong>master</strong> account. This is a client-side demo — not cryptographically secure.</footer>
  </div>

<script>
/*
  Vigenère decryption demo (always uses the provided key).
  Encoded lines were originally produced with key "master", but the script will
  attempt decryption with whatever key the user types.
*/

// Vigenère decrypt: shifts alphabetic characters; non-alpha pass through.
// Works with mixed-case; preserves case.
function vigenereDecrypt(ciphertext, key){
  if (!key) return ciphertext;
  let out = '';
  let ki = 0;
  const keyLower = key.toLowerCase();
  for (let i = 0; i < ciphertext.length; i++){
    const ch = ciphertext[i];
    if (/[A-Za-z]/.test(ch)){
      const isUpper = ch === ch.toUpperCase();
      const base = isUpper ? 'A'.charCodeAt(0) : 'a'.charCodeAt(0);
      const cval = ch.toLowerCase().charCodeAt(0) - 'a'.charCodeAt(0);
      const kch = keyLower[ki % keyLower.length];
      // if key contains non-letters, treat them as 'a' (shift 0)
      const kval = /[a-z]/.test(kch) ? (kch.charCodeAt(0) - 'a'.charCodeAt(0)) : 0;
      const pval = (cval - kval + 26) % 26;
      out += String.fromCharCode(base + pval);
      ki++;
    } else {
      out += ch;
    }
  }
  return out;
}

const lines = Array.from(document.querySelectorAll('[data-encoded]'));
const codeInput = document.getElementById('code');
const tryBtn = document.getElementById('tryBtn');
const status = document.getElementById('status');
const revealBtn = document.getElementById('revealBtn');
const resetBtn = document.getElementById('resetBtn');
const revealArea = document.getElementById('revealArea');

// On decrypt: always use the typed key and replace lines with decrypted results
tryBtn.addEventListener('click', () => {
  const key = (codeInput.value || '').trim();
  if (key.length === 0){
    status.textContent = 'Please enter a codeword (it can be anything).';
    status.style.color = '';
    return;
  }

  const decrypted = lines.map(el => vigenereDecrypt(el.dataset.original || el.textContent, key));

  // Replace displayed content with decrypted results and tag them as decrypted
  lines.forEach((el, idx) => {
    // store original encoded in dataset.original if not already stored (so Reset can restore)
    if (!el.dataset.original) el.dataset.original = el.textContent;
    el.textContent = decrypted[idx];
    el.style.background = 'linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.03))';
    el.style.color = '';
  });

  status.textContent = `Decrypted with key "${key}" — results shown below.`;
  status.style.color = '';
});

// Enter key triggers decrypt
codeInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter'){ tryBtn.click(); e.preventDefault(); }
});

// toggle raw encoded view
revealBtn.addEventListener('click', () => {
  if (revealArea.style.display === 'none' || revealArea.style.display === ''){
    // show originals (prefer dataset.original if present)
    const raw = lines.map(l => l.dataset.original || l.textContent).join('\n');
    revealArea.style.display = 'block';
    revealArea.textContent = raw;
    revealArea.setAttribute('aria-hidden','false');
    revealBtn.textContent = 'Hide raw encoded';
  } else {
    revealArea.style.display = 'none';
    revealArea.setAttribute('aria-hidden','true');
    revealBtn.textContent = 'Show raw encoded';
  }
});

// reset: restore original encoded strings (if stored), clear input
resetBtn.addEventListener('click', () => {
  lines.forEach(el => {
    if (el.dataset.original) el.textContent = el.dataset.original;
    el.style.color = '#dbeafe';
  });
  codeInput.value = '';
  status.textContent = 'Reset to encoded lines.';
  status.style.color = '';
  // hide reveal area if visible
  revealArea.style.display = 'none';
  revealArea.setAttribute('aria-hidden','true');
  revealBtn.textContent = 'Show raw encoded';
});

// initial styling & ensure originals are preserved (store originals)
(function init(){
  lines.forEach(el => {
    // store original encoded text in dataset.original so Reset can restore it
    if (!el.dataset.original) el.dataset.original = el.textContent;
    el.style.letterSpacing = '0.6px';
    el.style.color = '#dbeafe';
  });
  status.textContent = 'Enter any codeword and click Decrypt (or press Enter).';
  status.style.color = '';
})();
</script>
</body>
</html>
